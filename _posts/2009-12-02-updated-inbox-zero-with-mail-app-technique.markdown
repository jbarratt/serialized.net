--- 
wordpress_id: 344
layout: post
title: Updated "Inbox Zero with Mail.app" technique
wordpress_url: http://serialized.net/?p=344
---
Back in March, I wrote about my [technique for implementing Inbox Zero with Mail.app](http://serialized.net/2009/03/my-approach-to-inbox-zero-with-mailapp/).

Since then, the world has changed. I've upgraded to Snow Leopard, and Quicksilver has essentially stopped working out for me. (I've been trying to keep it up to date, and sometimes it kind of works, but my confidence levels are really low.) On the other hand, I'm loving me some [Google Quick Search Box](http://code.google.com/p/qsb-mac/) (a new project from the [original creator of Quicksilver](http://www.cultofmac.com/quicksilver-is-sort-of-dead-long-live-google-quick-search-box/6986)). The only feature that I still wanted Quicksilver for was triggers. And until today, I was still running it for trigger support to implement my Inbox Zero trick.

And then triggers broke when I upgraded it. And I'm out.

So here's how to get Inbox Zero magic in Mail.app using only tools native to Snow Leopard.

First, launch Automator and create a new Service workflow.
<img src="http://serialized.net/wp-content/uploads/2009/12/Automator_select_service.jpg" alt="Automator Create a new Service Workflow" title="Automator Create a new Service Workflow" width="556" height="517" class="aligncenter size-full wp-image-345" />

Select "Utilities" and then drag in "Run Applescript" to the window on the right.

<img src="http://serialized.net/wp-content/uploads/2009/12/automator-drag-run-applescript.jpg" alt="Automator: Run Applescript" title="Automator: Run Applescript" width="532" height="350" class="aligncenter size-full wp-image-346" />

Fill in your applescript, replacing only the center "comment" block -- leave the other autogenerated lines there.

The core code again, (tweak to fit your accounts and archive mailbox names)

{% highlight text %}
    tell application "Mail"
        set theSelectedMessages to selection
        set myAccount to "zimbra"
        set myMailbox to "Archive"
        repeat with theMessage in theSelectedMessages
            move theMessage to mailbox myMailbox of account myAccount
        end repeat
    end tell
[% endhighlight %}

It should look something like this:
<img src="http://serialized.net/wp-content/uploads/2009/12/automator_archive.jpg" alt="Automator: Archive Applescript" title="Automator: Archive Applescript" width="586" height="490" class="aligncenter size-full wp-image-349" />

And that's it! Save it, and give it a name you'll remember. (I chose "Archive Selected Mail.")

Now it's actually in Mail's Menu (under 'Services') and we can use the built in OSX hotkey support to launch it.

Go to the System Preferences Menu, click "Keyboard Shortcuts", and add one for the menu item you created. (It needs to be the same exact name you saved your service as.)

<img src="http://serialized.net/wp-content/uploads/2009/12/Keyboard-Shortcuts-Archive-Mail.jpg" alt="Keyboard Shortcuts: Archive Mail" title="Keyboard Shortcuts: Archive Mail" width="708" height="637" class="aligncenter size-full wp-image-350" />

Badda bing. Feature complete, and I can (sadly) retire Quicksilver forever. This technique should be extensible to all kinds of other cases when you want to add new features to applications, for access either through the menus or with hot keys.


